---
layout: layouts/base/index.njk
permalink: /index/
title: Index
---

{% macro entryLink(title, url, level) %}
  <a href="{{ url }}" class="index__link">
    {% if level == 1 %}
      <h1 class="index__title">
        {{ title }}
        <svg class="index__icon index__icon--arrow">
          <use xlink:href="#arrow"></use>
        </svg>
      </h1>
    {% else %}
      <h2 class="index__title">
        {{ title }}
        <svg class="index__icon index__icon--arrow">
          <use xlink:href="#arrow"></use>
        </svg>
      </h2>
    {% endif %}
  </a>
{% endmacro %}

{% if collections.indexItems | length %}
  <dl class="index" role="list">
    {% for item in collections.indexItems %}

      {# The tag assigned by the json file in the directory will always be the first tag #}
      {% set tagDef = item
        .data
        .tags[0] %}
      <dt class="index__type">
        {{ "Entry" if tagDef == "entries" }}
        {{ "Collection" if tagDef == "collections" }}
        {{ "Series" if tagDef == "series" }}
      </dt>

      <dd class="as-h1 index__desc">
        {% if tagDef == "entries" %}
          {# Entries #}
          {{ entryLink(item.data.title, item.url, 1) }}

        {% else %}
          {# Series & Collections #}
          {% set inputName = "expand-" ~ (item.data.title | slug) %}
          <input class="index__expand-input" type="checkbox" name="{{ inputName }}" id="{{ inputName }}">
          <label class="index__expand-label" for="{{ inputName }}">
            <h1 class="index__title">
              {{ item.data.title }}
              <svg class="index__icon index__icon--plus">
                <use xlink:href="#plus"></use>
              </svg>
              <svg class="index__icon index__icon--minus">
                <use xlink:href="#minus"></use>
              </svg>
            </h1>
          </label>
          <ol class="index__nest">
            {% if item.data.entries | length %}
              {% for entry in item.data.entries %}
                {% set entryUrl = "/entries/" ~ entry %}
                {% set entryTitle = collections.entriesMap[entry] %}
                <li class="index__nest__item">
                  {{ entryLink(entryTitle, entryUrl, 2) }}
                </li>
              {% endfor %}
            {% endif %}
          </ol>
        {% endif %}
      </dd>
    {% endfor %}
  </dl>
{% endif %}
